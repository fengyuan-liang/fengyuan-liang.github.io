# 接口幂等性研究

首先上业内Restful请求最佳实践

>幂等不修改服务器状态的用GET，幂等修改服务器状态的用PUT，不幂等修改服务器状态的用POST

- 首先GET请求很好理解，对资源做查询多次，此实现的结果都是一样的
- PUT请求的幂等性可以这样理解，将A修改为B，它第一次请求值变为了B，再进行多次此操作，最终的结果还是B，与一次执行的结果是一样的，所以PUT是幂等操作
- 同理可以理解DELETE操作，第一次将资源删除后，后面多次进行此删除请求，最终结果是一样的，将资源删除掉了
- POST不是幂等操作，因为一次请求添加一份新资源，二次请求则添加了两份新资源，多次请求会产生不同的结果，因此POST不是幂等操作

如果对业务进行严格细分，其实只有`GET`严格满足幂等性

1. `√ `满足幂等

2. `x` 不满足幂等

3. `-` 可能满足也可能不满足幂等，根据实际业务逻辑有关

   ![image-20220622095733693](https://cdn.fengxianhub.top/resources-master/202206220957910.png)

>如何保证接口幂等性？一般有四种方式
>
>1. 数据库唯一主键如何实现幂等
>2. 数据库乐观锁如何实现幂等性
>3. 防重 Token 令牌如何实现幂等性
>4. 下游传递唯一序列号如何实现幂等性